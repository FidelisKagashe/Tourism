{% extends 'base/base.html' %}
{% load i18n %}

{% block title %}{% trans "Set New Password" %} - {{ site_settings.site_name|default:"Safari & Bush Retreats" }}{% endblock %}

{% block extra_css %}
<style>
/* ------- Set New Password (Tailwind look, no Bootstrap) ------- */
.set-pass{
  --brand:#C18D45;            /* primary */
  --brand-600:#B07E3E;
  --muted:#6b7280;            /* gray-500 */
  --ok:#237D26;               /* accent green */
  --ok-600:#1E6B22;
  --red:#ef4444;              /* red-500 */
  --bg-card:#ffffff;
  --bg-card-dark:#1f2937;     /* gray-800 */
  --border:#e5e7eb;           /* gray-200 */
  --border-dark:#374151;      /* gray-700 */
  --text:#111827;             /* gray-900 */
  --text-dark:#f3f4f6;        /* gray-100 */
  --radius:16px;
  --shadow:0 10px 30px rgba(17,24,39,.08);
  font-family:'Poppins',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
}

/* kadi */
.set-pass .card{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
.dark .set-pass .card{ background:var(--bg-card-dark); border-color:var(--border-dark); }

/* icon ya kufuli */
.set-pass .icon{
  width:56px;height:56px;border-radius:14px;
  display:grid;place-items:center;margin:0 auto;
  color:var(--brand);
  background:color-mix(in srgb, var(--brand) 16%, transparent);
}

/* vichwa & maandishi */
.set-pass h1{ font-size:clamp(1.1rem,2.2vw,1.6rem); font-weight:800; color:var(--text); margin-top:.6rem; }
.dark .set-pass h1{ color:var(--text-dark); }
.set-pass .lead{ font-size:.98rem; color:var(--muted); }

/* sehemu ya mahitaji ya password (info) */
.set-pass .info{
  color:var(--ok-600);
  background:color-mix(in srgb, var(--ok) 10%, transparent);
  border:1px solid color-mix(in srgb, var(--ok) 24%, transparent);
  padding:.9rem 1rem; border-radius:12px;
}
.set-pass .info h6{ font-weight:800; margin:0 0 .35rem; }

/* onyo (invalid link) */
.set-pass .danger{
  color:var(--red);
  background:color-mix(in srgb, var(--red) 10%, white);
  border:1px solid color-mix(in srgb, var(--red) 35%, transparent);
  padding:.9rem 1rem; border-radius:12px;
}

/* lebo & inputs (hushika Django default + crispy) */
.set-pass .field label{
  display:block; font-weight:700; color:#111827; margin-bottom:.4rem; font-size:.95rem;
}
.dark .set-pass .field label{ color:#e5e7eb; }

.set-pass input[type="password"],
.set-pass input[type="text"],
.set-pass input[type="email"],
.set-pass .form-control{
  width:100%;
  border:1px solid var(--border);
  border-radius:12px;
  padding:.72rem .9rem;
  font-size:.95rem;
  background:#fff; color:#111827;
  transition:border-color .12s ease, box-shadow .12s ease, transform .05s ease;
}
.dark .set-pass input[type="password"],
.dark .set-pass input[type="text"],
.dark .set-pass input[type="email"],
.dark .set-pass .form-control{
  background:#111827; color:#f3f4f6; border-color:var(--border-dark);
}

.set-pass input:focus,
.set-pass .form-control:focus{
  outline:none;
  border-color:var(--brand-600);
  box-shadow:0 6px 18px rgba(193,141,69,.15);
}

/* errorlist ya Django */
.set-pass ul.errorlist{
  margin:.35rem 0 0; padding-left:1rem;
  color:var(--red); font-size:.88rem; list-style:disc;
}
.set-pass .error{ color:var(--red); font-size:.88rem; }

/* vitufe */
.set-pass .btn-primary{
  display:inline-flex; justify-content:center; align-items:center;
  width:100%;
  background:linear-gradient(180deg, var(--brand), var(--brand-600));
  color:#fff; font-weight:800; font-size:.98rem; letter-spacing:.01em;
  border:none; border-radius:12px; padding:.78rem 1rem; cursor:pointer;
  box-shadow:0 8px 24px rgba(193,141,69,.22);
  transition:transform .06s ease, box-shadow .12s ease, opacity .08s ease;
  text-decoration:none;
}
.set-pass .btn-primary:hover{ transform:translateY(-1px); }
.set-pass .btn-primary:active{ transform:translateY(0); }
.set-pass .btn-primary:focus{ outline:none; box-shadow:0 10px 30px rgba(193,141,69,.28); }

.set-pass .muted-link{
  color:#6b7280; text-decoration:none; font-weight:600;
}
.set-pass .muted-link:hover{ color:var(--brand); text-decoration:underline; }

/* spacing helpers */
.set-pass .stack>*+*{ margin-top:1rem; }
</style>
{% endblock %}

{% block content %}
<section class="set-pass py-10 md:py-16">
  <div class="container mx-auto px-4">
    <div class="mx-auto max-w-lg">
      <div class="card p-6 md:p-8">
        <div class="text-center">
          <div class="icon"><i class="fas fa-lock text-2xl" aria-hidden="true"></i></div>
          <h1>{% trans "Set New Password" %}</h1>
          <p class="lead">{% trans "Enter your new password below" %}</p>
        </div>

        {% if validlink %}
          <form method="post" class="mt-6" novalidate>
            {% csrf_token %}
            <div class="space-y-5">
              <div class="field">
                <label for="{{ form.new_password1.id_for_label }}">{% trans "New Password" %}</label>
                {{ form.new_password1 }}
                {% if form.new_password1.errors %}
                  <div class="error mt-1">{{ form.new_password1.errors }}</div>
                {% endif %}
              </div>

              <div class="field">
                <label for="{{ form.new_password2.id_for_label }}">{% trans "Confirm New Password" %}</label>
                {{ form.new_password2 }}
                {% if form.new_password2.errors %}
                  <div class="error mt-1">{{ form.new_password2.errors }}</div>
                {% endif %}
              </div>
            </div>

            <div class="info mt-6">
              <h6>{% trans "Password Requirements:" %}</h6>
              <ul class="list-disc list-inside text-sm space-y-1">
                <li>{% trans "At least 8 characters long" %}</li>
                <li>{% trans "Cannot be too similar to your personal information" %}</li>
                <li>{% trans "Cannot be a commonly used password" %}</li>
                <li>{% trans "Cannot be entirely numeric" %}</li>
              </ul>
            </div>

            <button type="submit" class="btn-primary mt-6">
              <i class="fas fa-check mr-2" aria-hidden="true"></i>{% trans "Set New Password" %}
            </button>
          </form>
        {% else %}
          <div class="danger mt-6 flex items-start gap-3">
            <i class="fas fa-exclamation-triangle text-lg mt-0.5" aria-hidden="true"></i>
            <div>
              <strong>{% trans "Invalid Reset Link" %}</strong><br>
              {% trans "This password reset link is invalid or has expired. Please request a new one." %}
            </div>
          </div>

          <a href="{% url 'accounts:password_reset' %}" class="btn-primary mt-5">
            <i class="fas fa-redo mr-2" aria-hidden="true"></i>{% trans "Request New Reset Link" %}
          </a>
        {% endif %}

        <div class="text-center mt-6">
          <a href="{% url 'accounts:login' %}" class="muted-link inline-flex items-center">
            <i class="fas fa-arrow-left mr-2" aria-hidden="true"></i>{% trans "Back to Login" %}
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
